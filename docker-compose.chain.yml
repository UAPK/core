version: '3.8'

services:
  anvil:
    image: ghcr.io/foundry-rs/foundry:latest
    container_name: uapk-chain
    command: >
      anvil
      --host 0.0.0.0
      --port 8545
      --chain-id 31337
      --block-time 1
      --accounts 10
      --balance 10000
    ports:
      - "127.0.0.1:8545:8545"
    volumes:
      - ${UAPK_DATA_DIR:-./uapk_data}/chain:/root/.foundry
    networks:
      - uapk-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8545"]
      interval: 10s
      timeout: 5s
      retries: 3

networks:
  uapk-network:
    driver: bridge
